<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Вход</title>
  <style>
    :root{ --bg:#0b1220; --card:#ffffff; --text:#0f172a; --muted:#64748b; --border:#e5e7eb; }
    html,body{ height:100%; margin:0; font-family:system-ui,-apple-system,"Segoe UI",sans-serif; background:linear-gradient(180deg,#0b1220 0%, #111827 100%); }
    .wrap{ min-height:100%; display:flex; align-items:center; justify-content:center; padding:24px; }
    .card{ width:min(420px, 94vw); background:var(--card); border:1px solid rgba(255,255,255,0.18);
      border-radius:18px; box-shadow:0 18px 40px rgba(0,0,0,0.35); padding:18px;
    }
    h1{ margin:0 0 10px 0; font-size:18px; color:var(--text); font-weight:900; }
    .sub{ margin:0 0 16px 0; font-size:12px; color:var(--muted); font-weight:600; }
    label{ display:block; font-size:12px; font-weight:800; color:#334155; margin:10px 0 6px; }
    input{ width:100%; box-sizing:border-box; padding:10px 12px; border-radius:12px; border:1px solid var(--border);
      font-size:13px; outline:none;
    }
    button{ margin-top:14px; width:100%; padding:10px 12px; border-radius:12px; border:1px solid #0f172a;
      background:#0f172a; color:#fff; font-weight:900; cursor:pointer;
    }
    button:disabled{ opacity:0.6; cursor:not-allowed; }
    .err{ margin-top:10px; font-size:12px; font-weight:700; color:#b91c1c; min-height:18px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Вход</h1>
      <p class="sub">Введите логин и пароль</p>

      <label for="u">Логин</label>
      <input id="u" autocomplete="username" />

      <label for="p">Пароль</label>
      <input id="p" type="password" autocomplete="current-password" />

      <button id="btn">Войти</button>
      <div class="err" id="err"></div>
    </div>
  </div>

<script>
  const u = document.getElementById('u');
  const p = document.getElementById('p');
  const btn = document.getElementById('btn');
  const err = document.getElementById('err');

  async function login(){
    err.textContent = '';
    btn.disabled = true;
    btn.textContent = 'Входим...';
    try{
      const r = await fetch('/api/login', {
        method:'POST',
        headers:{ 'Content-Type':'application/json', 'Accept':'application/json' },
        body: JSON.stringify({ username: (u.value||'').trim(), password: (p.value||'') })
      });
      const j = await r.json().catch(()=>null);
      if (!r.ok || !j?.ok) throw new Error(j?.error || ('HTTP '+r.status));
      window.location.href = '/';
    }catch(e){
      err.textContent = 'Ошибка входа: ' + (e?.message || e);
    }finally{
      btn.disabled = false;
      btn.textContent = 'Войти';
    }
  }

  btn.addEventListener('click', login);
  p.addEventListener('keydown', (e)=>{ if(e.key==='Enter') login(); });
</script>
</body>
</html>
